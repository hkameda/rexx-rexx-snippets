/* REXX */
'SUBCOM DSNREXX'
IF RC THEN
   S_RC = RXSUBCOM('ADD' , 'DSNREXX' , 'DSNREXX')
ADDRESS DSNREXX
CONNECT 'DSNX'  /* SUB SYSTEM */
IF SQLCODE <> 0 THEN SAY 'CONNECT SQLCODE =' SQLCODE
SQLSTMT = "SELECT TESTCOL FROM OWNER.TESTTBL WITH UR"
RECCNT = 0
"EXECSQL DECLARE C1 CURSOR FOR S1"
"EXECSQL PREPARE S1 FROM :SQLSTMT"
IF SQLCODE <> 0 THEN SAY 'PREPARE SQLCODE =' SQLCODE
"EXECSQL OPEN C1"
IF SQLCODE <> 0 THEN SAY 'PREPARE OPEN CSR=' SQLCODE
DO UNTIL (SQLCODE <> 0)
   "EXECSQL FETCH C1 INTO :TESTCOL"
   IF (SQLCODE <> 0 & SQLCODE <> 100) THEN SAY 'OPEN CSR=' SQLCODE
   IF SQLCODE = 0 THEN DO
      RECCNT = RECCNT + 1
   END
END
"EXECSQL CLOSE C1"
ADDRESS DSNREXX 'DISCONNECT'
S_RC = RXSUBCOM('DELETE','DSNREXX','DSNREXX')
SAY '現在、TESTTBLの件数は ' RECCNT '件です。'
EXIT
